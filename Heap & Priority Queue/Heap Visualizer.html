<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Heap Visualizer</title>
<style>
  :root{
    --bg:#0f1220; --panel:#161a2d; --panel-2:#1e2340;
    --accent:#6cf3ff; --accent-2:#8ae9c1;
    --text:#ecf2ff; --muted:#a6b0cf;
    --slot:#2a305a; --chip:#39407a;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --radius:16px; --speed:300ms;
    --pair:#ffd166; --new:#8ae9c1;
  }
  body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}
  header{padding:24px clamp(16px,4vw,32px);display:grid;grid-template-columns:1fr auto;gap:16px;align-items:center}
  h1{margin:0;font-size:clamp(22px,2.2vw,30px)}
  .subtitle{color:var(--muted);margin-top:6px;font-size:.95rem}
  .controls{display:flex;gap:10px;flex-wrap:wrap}
  input,button,select{background:linear-gradient(180deg,var(--panel-2),var(--panel));color:var(--text);border:1px solid #222842;border-radius:10px;padding:10px 12px;font-weight:600;box-shadow:var(--shadow)}
  button:hover{transform:translateY(-1px);border-color:#2c3256}
  main{padding:0 clamp(16px,4vw,32px) 32px;display:grid;grid-template-columns:1fr 1fr;gap:20px}
  @media(max-width:900px){main{grid-template-columns:1fr}}
  .panel{background:linear-gradient(180deg,var(--panel-2),var(--panel));border:1px solid #20264a;border-radius:var(--radius);box-shadow:var(--shadow)}
  .panel header{padding:12px 16px;background:#141832;border-bottom:1px solid #1f2546}
  .panel h2{margin:0;font-size:16px}
  .panel .content{padding:14px}

  /* Tree */
  svg{width:100%;height:100%;display:block}
  .edge{stroke:#6f78b8;stroke-width:2}
  .node circle{r:18;fill:#1d2350;stroke:#2e3a7d;stroke-width:2}
  .node text{fill:var(--text);font-weight:700;font-size:12px;text-anchor:middle;dominant-baseline:middle}

  /* Array */
  .array{display:flex;gap:10px;flex-wrap:wrap}
  .cell{padding:14px 16px;border-radius:12px;background:var(--slot);border:1px solid #2a2f58;font-weight:700;font-size:1rem}
</style>
</head>
<body>
<header>
  <div>
    <h1>ðŸŒ² Heap Visualizer</h1>
    <div class="subtitle">Complete binary tree with <b>heap property</b>. Stored in an <b>array</b>.</div>
  </div>
  <div class="controls">
    <input id="arrInput" value="42,29,18,14,7,18,12,11,13"/>
    <select id="heapType">
      <option value="max">Max Heap ðŸ”¼</option>
      <option value="min">Min Heap ðŸ”½</option>
    </select>
    <button id="btn-set">Set Heap</button>
    <button id="btn-rand">Random ðŸŽ²</button>
  </div>
</header>

<main>
  <section class="panel">
    <header><h2>Tree Representation</h2></header>
    <div class="content">
      <svg id="tree" viewBox="0 0 800 400"></svg>
    </div>
  </section>
  <section class="panel">
    <header><h2>Array Representation</h2></header>
    <div class="content">
      <div id="array" class="array"></div>
    </div>
  </section>
</main>

<script type="module">
const arrInput=document.getElementById('arrInput');
const heapTypeSel=document.getElementById('heapType');
const btnSet=document.getElementById('btn-set');
const btnRand=document.getElementById('btn-rand');
const arrayEl=document.getElementById('array');
const treeEl=document.getElementById('tree');

function parseArray(str){
  return str.split(',').map(s=>s.trim()).filter(Boolean).map(Number).filter(v=>!Number.isNaN(v));
}

function heapify(arr,type){
  const n=arr.length;
  const cmp= type==='max' ? ((a,b)=>a>b) : ((a,b)=>a<b);
  for(let i=Math.floor(n/2)-1;i>=0;i--) siftDown(arr,i,n,cmp);
}
function siftDown(arr,i,n,cmp){
  let largest=i;
  const l=2*i+1, r=2*i+2;
  if(l<n && !cmp(arr[largest],arr[l])) largest=l;
  if(r<n && !cmp(arr[largest],arr[r])) largest=r;
  if(largest!==i){ [arr[i],arr[largest]]=[arr[largest],arr[i]]; siftDown(arr,largest,n,cmp); }
}

function renderArray(arr){
  arrayEl.innerHTML='';
  arr.forEach((v,i)=>{
    const d=document.createElement('div');
    d.className='cell';
    d.textContent=`${i}: ${v}`;
    arrayEl.appendChild(d);
  });
}

function renderTree(arr){
  treeEl.innerHTML='';
  const n=arr.length;
  const levels=Math.floor(Math.log2(n))+1;
  const width=800, height=400;
  const nodes=[];
  for(let i=0;i<n;i++){
    const level=Math.floor(Math.log2(i+1));
    const posInLevel=i-(2**level-1);
    const nodesInLevel=2**level;
    const x=(width/(nodesInLevel+1))*(posInLevel+1);
    const y=(height/(levels+1))*(level+1);
    nodes.push({id:i,val:arr[i],x,y});
  }
  nodes.forEach(n=>{
    const l=2*n.id+1, r=2*n.id+2;
    if(l<nodes.length){
      const line=document.createElementNS('http://www.w3.org/2000/svg','line');
      line.setAttribute('x1',n.x); line.setAttribute('y1',n.y);
      line.setAttribute('x2',nodes[l].x); line.setAttribute('y2',nodes[l].y);
      line.setAttribute('class','edge');
      treeEl.appendChild(line);
    }
    if(r<nodes.length){
      const line=document.createElementNS('http://www.w3.org/2000/svg','line');
      line.setAttribute('x1',n.x); line.setAttribute('y1',n.y);
      line.setAttribute('x2',nodes[r].x); line.setAttribute('y2',nodes[r].y);
      line.setAttribute('class','edge');
      treeEl.appendChild(line);
    }
  });
  nodes.forEach(n=>{
    const g=document.createElementNS('http://www.w3.org/2000/svg','g');
    g.setAttribute('class','node');
    g.setAttribute('transform',`translate(${n.x},${n.y})`);
    g.innerHTML=`<circle></circle><text dy="4">${n.val}</text>`;
    treeEl.appendChild(g);
  });
}

function reset(){
  const arr=parseArray(arrInput.value);
  heapify(arr,heapTypeSel.value);
  renderArray(arr);
  renderTree(arr);
}
function randomArr(){
  const len=Math.floor(Math.random()*8)+5;
  const arr=Array.from({length:len},()=>Math.floor(Math.random()*50));
  arrInput.value=arr.join(',');
  reset();
}

btnSet.onclick=reset;btnRand.onclick=randomArr;
heapTypeSel.onchange=reset;
reset();
</script>
</body>
</html>
