<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Anagram Detection Visualizer</title>
<style>
  :root{
    --bg:#0f1220; --panel:#161a2d; --panel-2:#1e2340;
    --accent:#6cf3ff; --accent-2:#8ae9c1;
    --text:#ecf2ff; --muted:#a6b0cf;
    --slot:#2a305a; --chip:#39407a;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --radius:16px; --speed:300ms;
    --pair:#ffd166; --new:#8ae9c1; --bad:#b05a7a;
  }
  body{margin:0;background:var(--bg);color:var(--text);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}
  header{padding:24px clamp(16px,4vw,32px);display:grid;grid-template-columns:1fr auto;gap:16px;align-items:center}
  h1{margin:0;font-size:clamp(22px,2.2vw,30px)}
  .subtitle{color:var(--muted);margin-top:6px;font-size:.95rem}
  .controls{display:flex;gap:10px;flex-wrap:wrap}
  input,button{background:linear-gradient(180deg,var(--panel-2),var(--panel));color:var(--text);border:1px solid #222842;border-radius:10px;padding:10px 12px;font-weight:600;box-shadow:var(--shadow)}
  button:hover{transform:translateY(-1px);border-color:#2c3256}
  main{padding:0 clamp(16px,4vw,32px) 32px;display:grid;grid-template-columns:1.1fr .9fr;gap:20px}
  @media(max-width:900px){main{grid-template-columns:1fr}}
  .panel{background:linear-gradient(180deg,var(--panel-2),var(--panel));border:1px solid #20264a;border-radius:var(--radius);box-shadow:var(--shadow)}
  .panel header{padding:12px 16px;background:#141832;border-bottom:1px solid #1f2546}
  .panel h2{margin:0;font-size:16px}
  .panel .content{padding:14px}
  .str{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .char{padding:12px 14px;border-radius:12px;background:var(--slot);border:1px solid #2a2f58;font-weight:700;font-size:1.1rem;transition:all var(--speed)}
  .char.active{outline:2px solid var(--pair)}
  .char.bad{outline:2px solid var(--bad)}
  .map{display:grid;gap:10px}
  .entry{display:grid;grid-template-columns:1fr auto;align-items:center;padding:10px;border-radius:12px;background:var(--slot);border:1px solid #2a2f58}
  .entry.new{outline:2px solid var(--new)}
  .entry.bad{outline:2px solid var(--bad);background:#2a1f2f}
  .entry .count{font-weight:700;color:var(--accent-2)}
  .explain{background:#101433;border-top:1px solid #1f2546;padding:12px 14px}
  .explain b{color:var(--accent)}
  .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas;background:#0e1230;border:1px solid #1c2250;padding:2px 6px;border-radius:8px}
</style>
</head>
<body>
<header>
  <div>
    <h1>🔤 Anagram Detection</h1>
    <div class="subtitle">Two strings are anagrams if they have the same <b>character frequencies</b>.</div>
  </div>
  <div class="controls">
    <input id="s1" value="listen"/>
    <input id="s2" value="silent"/>
    <button id="btn-set">Set Strings</button>
    <button id="btn-play">▶ Play</button>
    <button id="btn-step">Step ▷</button>
    <button id="btn-reset">Reset ↺</button>
  </div>
</header>

<main>
  <section class="panel">
    <header><h2>Strings</h2></header>
    <div class="content">
      <div><b>str1:</b></div>
      <div id="str1" class="str"></div>
      <div><b>str2:</b></div>
      <div id="str2" class="str"></div>
    </div>
    <div class="explain" id="explain">Step through: build frequency from str1, then subtract with str2.</div>
  </section>
  <section class="panel">
    <header><h2>Hash Map</h2></header>
    <div class="content"><div id="map" class="map"></div></div>
  </section>
</main>

<script type="module">
const s1Input=document.getElementById('s1');
const s2Input=document.getElementById('s2');
const str1El=document.getElementById('str1');
const str2El=document.getElementById('str2');
const mapEl=document.getElementById('map');
const explainEl=document.getElementById('explain');
const btnSet=document.getElementById('btn-set');
const btnPlay=document.getElementById('btn-play');
const btnStep=document.getElementById('btn-step');
const btnReset=document.getElementById('btn-reset');

const STATE={s1:[],s2:[],map:{},i:0,phase:1,running:false,timer:null,done:false};

function renderStrings(){
  str1El.innerHTML=''; str2El.innerHTML='';
  STATE.s1.forEach((ch,idx)=>{
    const d=document.createElement('div');
    let cls='char'; if(STATE.phase===1 && idx===STATE.i)cls+=' active';
    d.className=cls; d.textContent=ch; str1El.appendChild(d);
  });
  STATE.s2.forEach((ch,idx)=>{
    const d=document.createElement('div');
    let cls='char'; if(STATE.phase===2 && idx===STATE.i)cls+=' active';
    d.className=cls; d.textContent=ch; str2El.appendChild(d);
  });
}
function renderMap(flash=null,badKey=null){
  mapEl.innerHTML='';
  Object.entries(STATE.map).forEach(([k,v])=>{
    const d=document.createElement('div');
    let cls='entry'; if(k===flash)cls+=' new'; if(k===badKey)cls+=' bad';
    d.className=cls; d.innerHTML=`<div>${k}</div><div class="count">${v}</div>`;
    mapEl.appendChild(d);
  });
}
function explain(html){explainEl.innerHTML=html}

function reset(){
  STATE.s1=[...s1Input.value]; STATE.s2=[...s2Input.value];
  STATE.map={}; STATE.i=0; STATE.phase=1; STATE.done=false;
  STATE.running=false; clearTimeout(STATE.timer); STATE.timer=null;
  btnPlay.textContent='▶ Play';
  renderStrings();renderMap();explain('Ready. Phase 1: build counts from str1.');
}
function step(){
  if(STATE.done)return false;
  if(STATE.s1.length!==STATE.s2.length){
    explain('Lengths differ → not anagrams.'); STATE.done=true; return false;
  }
  if(STATE.phase===1){
    if(STATE.i<STATE.s1.length){
      const ch=STATE.s1[STATE.i];
      STATE.map[ch]=(STATE.map[ch]||0)+1;
      renderStrings();renderMap(ch);
      explain(`Phase1: Add char <b>${ch}</b>. Count=${STATE.map[ch]}.`);
      STATE.i++;return true;
    } else {
      STATE.phase=2;STATE.i=0;explain('Phase2: subtract counts using str2.');renderStrings();return true;
    }
  } else {
    if(STATE.i<STATE.s2.length){
      const ch=STATE.s2[STATE.i];
      if(!STATE.map[ch]){ renderMap(null,ch); explain(`Char <b>${ch}</b> not found or count=0 → not anagram.`); STATE.done=true; return false;}
      STATE.map[ch]--; renderStrings();renderMap(ch,STATE.map[ch]<0?ch:null);
      if(STATE.map[ch]<0){ explain(`Count of <b>${ch}</b> went negative → not anagram.`); STATE.done=true; return false;}
      explain(`Phase2: Subtract char <b>${ch}</b>. Count=${STATE.map[ch]}.`);
      STATE.i++;return true;
    } else {
      // finished str2
      const leftover=Object.values(STATE.map).some(v=>v!==0);
      if(leftover){ explain('Some counts ≠ 0 → not anagram.'); }
      else{ explain('<b>Success!</b> All counts zero → strings are anagrams.'); }
      STATE.done=true; return false;
    }
  }
}
function play(){
  if(STATE.running){STATE.running=false;btnPlay.textContent='▶ Play';clearTimeout(STATE.timer);return}
  STATE.running=true;btnPlay.textContent='⏸ Pause';
  const tick=()=>{ if(!STATE.running)return;const more=step();if(!more){STATE.running=false;btnPlay.textContent='▶ Play';return}STATE.timer=setTimeout(tick,1000)};
  tick();
}
btnSet.onclick=reset;btnReset.onclick=reset;
btnStep.onclick=()=>{if(STATE.running)play();step()};
btnPlay.onclick=play;
window.addEventListener('keydown',e=>{
  if(e.key===' '){e.preventDefault();play()}
  if(e.key.toLowerCase()==='n'){step()}
  if(e.key.toLowerCase()==='r'){reset()}
});
reset();

/* Reference
function isAnagram(str1,str2):
    if length(str1)!=length(str2): return false
    hashMap={}
    for char in str1: hashMap[char]+=1
    for char in str2: hashMap[char]-=1; if hashMap[char]<0: return false
    return true
*/
</script>
</body>
</html>
