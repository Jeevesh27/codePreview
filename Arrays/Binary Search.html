<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Binary Search Visualizer</title>
<style>
  :root{
    --bg:#0f1220; --panel:#161a2d; --panel-2:#1e2340;
    --text:#ecf2ff; --muted:#a6b0cf;
    --pair:#ffd166; --active:#6cf3ff; --done:#8ae9c1;
    --edge:#556; --edge-pair:#e3b84a; --edge-done:#6fae97;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --warn:#ffd166; --fail:#ff6b6b;
  }

  *{box-sizing:border-box}
  body{
    margin:0; background: radial-gradient(1200px 800px at 70% -10%, #20264a 0%, var(--bg) 40%);
    color:var(--text); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
    min-height:100vh; padding:32px 16px 64px; display:grid; place-items:start center;
  }
  .app{ width:min(1100px,100%); display:grid; gap:16px; }
  .panel{
    background:linear-gradient(180deg,var(--panel) 0%, var(--panel-2) 100%);
    border:1px solid #1a2040; border-radius:14px; box-shadow:var(--shadow); padding:18px;
  }
  .title-row{ display:flex; gap:12px; align-items:center; flex-wrap:wrap;}
  h1{ margin:0; font-size:clamp(22px,3vw,28px);}
  .badge{ background:#0b1022; border:1px solid #28305a; color:var(--muted); padding:6px 10px; border-radius:999px; font-size:12px; display:inline-flex; gap:6px; align-items:center;}
  .badge b{ color:var(--text); }
  .pill{ background:#0e1430; border:1px dashed #2a325e; padding:6px 10px; border-radius:10px;}
  .pill b{ color:var(--pair); }

  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
  label{ color:var(--muted); font-size:14px;}
  input[type="number"], input[type="text"]{
    background:#0d1126; border:1px solid #242b51; color:var(--text); border-radius:10px; padding:10px 12px; outline:none;
  }
  input[type="text"]{ min-width:260px; }
  button{
    background:#0e1736; color:var(--text); border:1px solid #2b3563; border-radius:12px; padding:10px 14px; cursor:pointer;
    transition:transform .05s ease, background .15s ease, border-color .15s ease;
  }
  button:hover{ background:#121c44; }
  button:active{ transform:translateY(1px); }
  button.primary{ background:linear-gradient(180deg,#0f2b3a,#0b1f2b); border-color:#284a60; }
  button:disabled{ opacity:.55; cursor:not-allowed; }

  .array{
    display:grid; grid-auto-flow:column; grid-auto-columns:minmax(64px,1fr);
    gap:10px; padding:12px; border-radius:12px; background:#101634; border:1px solid #222a55; overflow-x:auto;
  }
  .cell{
    position:relative; background:#0c1128; border:1px solid #27305b; border-radius:10px; min-height:72px;
    display:grid; place-items:center; color:var(--text); font-weight:600; letter-spacing:.2px;
    transition: all .25s ease;
  }
  .index{ position:absolute; top:6px; left:8px; font:11px/1.1 ui-monospace; color:var(--muted); opacity:.85;}
  .cell.visited{ background:#0d1f22; border-color:var(--edge-done); }
  .cell.low { outline:2px solid var(--active); }
  .cell.mid { outline:3px solid var(--pair); }
  .cell.high{ outline:2px dashed var(--active); }
  .cell.out { opacity:.35; filter:grayscale(.4); }
  .cell.found{ background:#0f1f1a; outline:3px solid var(--done); }
  .cell.fail { outline:2px solid var(--fail); }

  .legend{ display:flex; gap:14px; flex-wrap:wrap; color:var(--muted); font-size:14px;}
  .dot{ width:10px; height:10px; border-radius:999px; display:inline-block; margin-right:6px; vertical-align:middle;}
  .dot.active{ background:var(--active); }
  .dot.pair{ background:var(--pair); }
  .dot.done{ background:var(--done); }
  .dot.fail{ background:var(--fail); }

  pre{ margin:0; background:#0b1026; border:1px solid #222a55; border-radius:12px; padding:14px; overflow:auto; box-shadow:var(--shadow); color:var(--text);}
  code{ font:13px/1.45 ui-monospace, SFMono-Regular, Menlo, Consolas; }
  .note{ color:var(--muted); }
  .msg{ color:var(--muted); font-size:14px; }
  .msg strong{ color:var(--text); }
</style>
</head>
<body>
<main class="app">
  <section class="panel">
    <div class="title-row">
      <h1>üîπ Binary Search ‚Äî divide the array into halves</h1>
      <span class="badge">‚úÖ Sorted array only</span>
      <span class="badge">‚è± Time: <b>O(log n)</b></span>
      <span class="badge">üì¶ Space: <b>O(1)</b></span>
    </div>
    <div class="pill">Tip: we auto-sort your input to keep the precondition true.</div>
  </section>

  <section class="panel">
    <div class="row">
      <label>Array (sorted)</label>
      <input id="contents" type="text" value="3, 7, 9, 12, 18, 21, 27, 31" />
      <button id="apply" class="primary">Apply & Sort</button>
      <button id="random">Random Sorted</button>
      <span class="badge">Length: <b id="len">8</b></span>
    </div>
    <div class="row">
      <label>Target</label>
      <input id="target" type="text" value="18" />
      <button id="auto" class="primary">‚ñ∂ Auto</button>
      <button id="step">‚è≠ Step</button>
      <button id="reset">‚ôª Reset</button>
      <span id="msg" class="msg"></span>
    </div>
    <div class="row">
      <label>Speed</label>
      <input id="speed" type="range" min="0" max="100" value="45" />
      <span id="speedLabel">Medium</span>
    </div>
  </section>

  <section class="panel" aria-label="Visualization">
    <div id="array" class="array"></div>
    <div class="legend" style="margin-top:8px;">
      <span><span class="dot active"></span> low / high bounds</span>
      <span><span class="dot pair"></span> mid check</span>
      <span><span class="dot done"></span> visited</span>
      <span><span class="dot fail"></span> not found</span>
    </div>
  </section>

  <section class="panel">
    <h2 style="margin:0 0 10px;">Pseudo-code</h2>
<pre><code>function binarySearch(arr, x):
    low ‚Üê 0, high ‚Üê arr.length - 1
    while low ‚â§ high:
        mid ‚Üê low + ‚åä(high - low) / 2‚åã
        if arr[mid] == x: return mid
        else if arr[mid] &lt; x: low ‚Üê mid + 1
        else: high ‚Üê mid - 1
    return -1
</code></pre>
    <p class="note">Each step halves the search range ‚Üí <b>O(log n)</b>.</p>
  </section>
</main>

<script>
const state = {
  arr: [3,7,9,12,18,21,27,31],
  low: 0,
  high: 7,
  mid: 3,
  target: 18,
  running: false,
  delay: 380,
  finished: false
};

const elArray = document.getElementById('array');
const elContents = document.getElementById('contents');
const elApply = document.getElementById('apply');
const elRandom = document.getElementById('random');
const elLen = document.getElementById('len');
const elTarget = document.getElementById('target');
const btnAuto = document.getElementById('auto');
const btnStep = document.getElementById('step');
const btnReset = document.getElementById('reset');
const elSpeed = document.getElementById('speed');
const elSpeedLabel = document.getElementById('speedLabel');
const elMsg = document.getElementById('msg');

const clamp = (n,a,b)=>Math.max(a,Math.min(b,n));
const wait = (ms)=>new Promise(r=>setTimeout(r,ms));
function speedToDelay(v){
  const t = clamp(v,0,100)/100;
  const eased = 1 - Math.pow(t,1.6);
  return 70 + Math.round(eased*700);
}
function labelSpeed(v){
  v = +v;
  if (v<20) return 'Fastest';
  if (v<40) return 'Fast';
  if (v<60) return 'Medium';
  if (v<80) return 'Slow';
  return 'Slowest';
}
function coerceNumList(str){
  const parts = str.split(',').map(s=>s.trim()).filter(Boolean).map(Number).filter(n=>!Number.isNaN(n));
  return parts.sort((a,b)=>a-b);
}
function randomSorted(n = clamp(Math.floor(Math.random()*6)+6,5,12)){
  const arr = Array.from({length:n},()=>Math.floor(Math.random()*90)+10).sort((a,b)=>a-b);
  return arr;
}

function render(){
  elArray.innerHTML = '';
  state.arr.forEach((v,i)=>{
    const cell = document.createElement('div');
    cell.className = 'cell';
    cell.dataset.index = i;
    cell.innerHTML = `<div class="index">${i}</div><div class="value">${v}</div>`;
    elArray.appendChild(cell);
  });
  elLen.textContent = state.arr.length;
  paintPointers();
}

function clearMarks(){
  [...elArray.children].forEach(c=>{
    c.classList.remove('low','mid','high','visited','out','found','fail');
  });
}

function paintPointers(){
  clearMarks();
  const cells = [...elArray.children];
  // dim everything outside [low, high]
  cells.forEach((c,idx)=>{
    if (idx < state.low || idx > state.high) c.classList.add('out');
    else c.classList.remove('out');
  });
  if (state.low <= state.high){
    cells[state.low]?.classList.add('low');
    cells[state.high]?.classList.add('high');
    const m = state.low + Math.floor((state.high - state.low)/2);
    state.mid = m;
    cells[m]?.classList.add('mid');
    // mark visited window
    for (let i=state.low; i<=state.high; i++){
      cells[i]?.classList.add('visited');
    }
  }
}

function resetSearch(){
  state.low = 0;
  state.high = state.arr.length - 1;
  state.mid = Math.floor((state.low + state.high)/2);
  state.finished = false;
  state.running = false;
  btnAuto.textContent = '‚ñ∂ Auto';
  elMsg.textContent = '';
  render();
}

async function stepOnce(){
  if (state.finished) return;
  if (state.low > state.high){
    // not found
    [...elArray.children].forEach(c=>c.classList.add('fail'));
    elMsg.textContent = 'Not found (return -1)';
    state.finished = true;
    state.running = false;
    btnAuto.textContent = '‚ñ∂ Auto';
    return;
  }

  paintPointers();
  await wait(state.delay);

  const midVal = state.arr[state.mid];
  const target = state.target;

  const midCell = elArray.children[state.mid];
  // compare
  if (midVal === target){
    midCell.classList.add('found');
    elMsg.textContent = `Found at index ${state.mid}`;
    state.finished = true;
    state.running = false;
    btnAuto.textContent = '‚ñ∂ Auto';
    return;
  }

  if (midVal < target){
    state.low = state.mid + 1;
  } else {
    state.high = state.mid - 1;
  }

  // repaint new bounds
  paintPointers();
}

async function autoRun(){
  if (state.running){
    // pause
    state.running = false;
    btnAuto.textContent = '‚ñ∂ Auto';
    return;
  }
  state.running = true;
  btnAuto.textContent = '‚è∏ Pause';
  while (state.running && !state.finished){
    await stepOnce();
    if (!state.finished) await wait(state.delay*0.6);
  }
}

elApply.addEventListener('click', ()=>{
  const arr = coerceNumList(elContents.value);
  if (arr.length === 0) return;
  state.arr = arr;
  state.target = Number(elTarget.value);
  render();
  resetSearch();
});
elRandom.addEventListener('click', ()=>{
  state.arr = randomSorted();
  elContents.value = state.arr.join(', ');
  render();
  resetSearch();
});
elTarget.addEventListener('change', ()=>{
  const n = Number(elTarget.value);
  if (!Number.isNaN(n)) state.target = n;
  resetSearch();
});
btnStep.addEventListener('click', stepOnce);
btnAuto.addEventListener('click', autoRun);
btnReset.addEventListener('click', resetSearch);
elSpeed.addEventListener('input', (e)=>{
  state.delay = speedToDelay(+e.target.value);
  elSpeedLabel.textContent = labelSpeed(+e.target.value);
});

(function init(){
  state.delay = speedToDelay(+elSpeed.value);
  elSpeedLabel.textContent = labelSpeed(+elSpeed.value);
  // coerce initial
  state.arr = coerceNumList(elContents.value);
  state.target = Number(elTarget.value);
  render();
  resetSearch();
})();
</script>
</body>
</html>
